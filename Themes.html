<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>X Edge — Theme</title>

  <link rel="icon" href="xedge-logo.png">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-950 text-white">

<!-- NAV (reuse your nav) -->
<nav class="bg-gray-900/80 border-b border-gray-800 fixed w-full z-50">
  <div class="max-w-6xl mx-auto px-6 py-3 flex justify-between items-center">
    <a href="index.html" class="flex items-center gap-3">
      <img src="xedge-logo.png" class="w-8 h-8 bg-white p-1 rounded">
      <span class="font-bold">X Edge</span>
    </a>
    <button onclick="history.back()"
      class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg">
      ← Back
    </button>
  </div>
</nav>

<main class="pt-28 max-w-6xl mx-auto px-6">

  <!-- HEADER -->
  <div class="mb-10">
    <h1 id="theme-title" class="text-4xl font-bold mb-3"></h1>
    <p id="theme-desc" class="text-gray-400 max-w-2xl"></p>
  </div>

  <!-- PROCESS EXPLANATION -->
  <section id="theme-process"
    class="bg-gray-800/40 border border-gray-700 rounded-xl p-6 mb-12">
  </section>

  <!-- TOOLS BY CATEGORY -->
  <section id="theme-tools" class="space-y-12"></section>

</main>

<script src="tools.js"></script>

<script>
const THEME_EXPLANATIONS = {
  "create your website": `
    <h2 class="text-2xl font-bold mb-2">How this works</h2>
    <p class="text-gray-300">
      To create a website, you typically combine design tools, copywriting tools,
      AI assistants, and sometimes chatbots. These tools work together to design,
      write, build, and optimize your site.
    </p>
  `,
  "be an influencer": `
    <h2 class="text-2xl font-bold mb-2">How this works</h2>
    <p class="text-gray-300">
      Influencers use content creation, editing, caption writing, analytics,
      and growth tools together to consistently publish and grow an audience.
    </p>
  `
};

function normalize(s) {
  return String(s || "").toLowerCase().trim();
}

async function renderThemePage() {
  const params = new URLSearchParams(location.search);
  const themeRaw = params.get("theme");
  if (!themeRaw) return;

  const theme = normalize(themeRaw);

  document.getElementById("theme-title").textContent = themeRaw;
  document.getElementById("theme-desc").textContent =
    "Tools curated to help you achieve this goal.";

  document.getElementById("theme-process").innerHTML =
    THEME_EXPLANATIONS[theme] || `
      <h2 class="text-2xl font-bold mb-2">How this works</h2>
      <p class="text-gray-300">
        These tools are commonly used together to achieve this goal efficiently.
      </p>
    `;

  const tools = await getTools();

  // Filter by theme
  const themedTools = tools.filter(t =>
    (t.themes || "")
      .toLowerCase()
      .split(",")
      .map(x => x.trim())
      .includes(theme)
  );

  // Group by category
  const groups = {};
  themedTools.forEach(t => {
    const cat = t.category || "Other";
    (groups[cat] ||= []).push(t);
  });

  const container = document.getElementById("theme-tools");

  Object.entries(groups).forEach(([category, tools]) => {
    const main = tools.slice(0, 3);
    const alternatives = tools.slice(3);

    container.innerHTML += `
      <div>
        <h2 class="text-2xl font-bold mb-4">${category}</h2>

        <div class="grid md:grid-cols-3 gap-4 mb-4">
          ${main.map(t => toolCard(t)).join("")}
        </div>

        ${
          alternatives.length
            ? `
              <details class="mt-2">
                <summary class="cursor-pointer text-blue-400">
                  View alternatives
                </summary>
                <div class="grid md:grid-cols-3 gap-4 mt-4">
                  ${alternatives.map(t => toolCard(t)).join("")}
                </div>
              </details>
            `
            : ""
        }
      </div>
    `;
  });
}

function toolCard(t) {
  const logo = t.logo_url ||
    `https://dummyimage.com/200x200/1e293b/ffffff&text=${encodeURIComponent(t.name)}`;

  return `
    <a href="tool.html?tool=${encodeURIComponent(t.name)}"
       class="bg-gray-800/40 border border-gray-700 rounded-xl p-4
              hover:bg-gray-800 transition">
      <img src="${logo}" class="w-14 h-14 rounded mb-3 object-cover">
      <h3 class="font-semibold">${t.name}</h3>
      <p class="text-sm text-gray-400">${t.short_description || ""}</p>
    </a>
  `;
}

document.addEventListener("DOMContentLoaded", renderThemePage);
</script>

</body>
</html>
